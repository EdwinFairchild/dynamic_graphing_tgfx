/*********************************************************************************/
/********** THIS FILE IS GENERATED BY TOUCHGFX DESIGNER, DO NOT MODIFY ***********/
/*********************************************************************************/
#include <gui_generated/graphing_screen_screen/graphing_ScreenViewBase.hpp>
#include <touchgfx/canvas_widget_renderer/CanvasWidgetRenderer.hpp>
#include <touchgfx/Color.hpp>
#include <images/BitmapDatabase.hpp>

graphing_ScreenViewBase::graphing_ScreenViewBase() :
    flexButtonCallback(this, &graphing_ScreenViewBase::flexButtonCallbackHandler),
    animationEndedCallback(this, &graphing_ScreenViewBase::animationEndedCallbackHandler),
    interaction2EndedCallback(this, &graphing_ScreenViewBase::interaction2EndedCallbackHandler),
    interaction3EndedCallback(this, &graphing_ScreenViewBase::interaction3EndedCallbackHandler)
{
    touchgfx::CanvasWidgetRenderer::setupBuffer(canvasBuffer, CANVAS_BUFFER_SIZE);
    
    __background.setPosition(0, 0, 800, 480);
    __background.setColor(touchgfx::Color::getColorFromRGB(0, 0, 0));
    add(__background);

    container1.setPosition(0, 0, 800, 480);
    add(container1);

    box1.setPosition(0, 0, 800, 480);
    box1.setColor(touchgfx::Color::getColorFromRGB(54, 53, 59));
    add(box1);

    box2.setPosition(0, 0, 800, 480);
    box2.setColor(touchgfx::Color::getColorFromRGB(0, 0, 0));
    add(box2);

    flexButton1.setBoxWithBorderPosition(0, 0, 0, 208);
    flexButton1.setBorderSize(5);
    flexButton1.setBoxWithBorderColors(touchgfx::Color::getColorFromRGB(0, 102, 153), touchgfx::Color::getColorFromRGB(0, 153, 204), touchgfx::Color::getColorFromRGB(0, 51, 102), touchgfx::Color::getColorFromRGB(51, 102, 153));
    flexButton1.setAction(flexButtonCallback);
    flexButton1.setPosition(27, 105, 191, 208);
    add(flexButton1);

    background.setXY(0, 0);
    background.setBitmap(touchgfx::Bitmap(BITMAP_BACKGROUND_ID));
    add(background);

    gauge1.setBackground(touchgfx::Bitmap(BITMAP_GAUGE_ID));
    gauge1.setBackgroundOffset(0, -45);
    gauge1.setPosition(232, -40, 336, 336);
    gauge1.setCenter(168, 168);
    gauge1.setStartEndAngle(-117, 121);
    gauge1.setRange(10, 100);
    gauge1.setValue(92);
    gauge1.setNeedle(BITMAP_NEEDLE_ID, 10, 96);
    gauge1.setMovingNeedleRenderingAlgorithm(touchgfx::TextureMapper::BILINEAR_INTERPOLATION);
    gauge1.setSteadyNeedleRenderingAlgorithm(touchgfx::TextureMapper::BILINEAR_INTERPOLATION);
    gauge1.setArcVisible();
    gauge1Painter.setBitmap(touchgfx::Bitmap(BITMAP_SWOOP_ID));
    gauge1.getArc().setPainter(gauge1Painter);
    gauge1.getArc().setRadius(137);
    gauge1.getArc().setLineWidth(136);
    gauge1.getArc().setCapPrecision(180);
    gauge1.setArcPosition(33, 33, 270, 198);
    add(gauge1);

    middle.setPosition(206, 199, 371, 281);
    car.setXY(66, 76);
    car.setBitmaps(BITMAP_CAR_00_ID, BITMAP_CAR_55_ID);
    car.setUpdateTicksInterval(2);
    car.startAnimation(false, true, false);
    car.setDoneAction(animationEndedCallback);
    middle.add(car);

    Image3.setXY(12, -111);
    Image3.setBitmap(touchgfx::Bitmap(BITMAP_VECTOR_20_ID));
    middle.add(Image3);

    Image4.setXY(222, -108);
    Image4.setBitmap(touchgfx::Bitmap(BITMAP_VECTOR_19_ID));
    middle.add(Image4);

    circle.setXY(51, 127);
    circle.setBitmap(touchgfx::Bitmap(BITMAP_VECTOR_ID));
    middle.add(circle);

    add(middle);
}

graphing_ScreenViewBase::~graphing_ScreenViewBase()
{
    touchgfx::CanvasWidgetRenderer::resetBuffer();
}

void graphing_ScreenViewBase::setupScreen()
{
    transitionBegins();
}

void graphing_ScreenViewBase::flexButtonCallbackHandler(const touchgfx::AbstractButtonContainer& src)
{
    if (&src == &flexButton1)
    {
        //Interaction1
        //When flexButton1 clicked call virtual function
        //Call buttonSpeed
        buttonSpeed();
    }
}

void graphing_ScreenViewBase::animationEndedCallbackHandler(const touchgfx::AnimatedImage& src)
{
    if (&src == &car)
    {
        //Interaction2
        //When car animation ended fade gauge1
        //Fade gauge1 to alpha:255 with LinearIn easing in 500 ms (30 Ticks)
        gauge1.clearFadeAnimationEndedAction();
        gauge1.startFadeAnimation(255, 30, touchgfx::EasingEquations::linearEaseIn);
        gauge1.setFadeAnimationEndedAction(interaction2EndedCallback);
    }
}

void graphing_ScreenViewBase::interaction2EndedCallbackHandler(const touchgfx::FadeAnimator<touchgfx::Gauge>& comp)
{
    //Interaction3
    //When Interaction2 completed fade background
    //Fade background to alpha:255 with LinearIn easing in 500 ms (30 Ticks)
    background.clearFadeAnimationEndedAction();
    background.startFadeAnimation(255, 30, touchgfx::EasingEquations::linearEaseIn);
    background.setFadeAnimationEndedAction(interaction3EndedCallback);

}

void graphing_ScreenViewBase::transitionBegins()
{
    //Interaction4
    //When screen transition begins fade circle
    //Fade circle to alpha:255 with LinearIn easing in 2500 ms (150 Ticks)
    circle.clearFadeAnimationEndedAction();
    circle.startFadeAnimation(255, 150, touchgfx::EasingEquations::linearEaseIn);
}

void graphing_ScreenViewBase::interaction3EndedCallbackHandler(const touchgfx::FadeAnimator<touchgfx::Image>& comp)
{
    //Interaction5
    //When Interaction3 completed call virtual function
    //Call allVisibleDone
    allVisibleDone();

}
